Objective-C 入门
====

##文档结构
Objective-C，顾名思义，面向对象的C。它继承了C的语法，但是又由一种面向对象的思路实现。

事实上，如果你在写C的时候就有习惯于设计良好的文档结构，那么你对OBJ-C的文档结构一定不会陌生。

OBJ-C的的程序文件由类组成，而每个类则由两个文件构成：
- .h文件用来对公共属性和方法进行声明
- .m文件用来实现内部细节。.m文件的开头使用#import来引入对应的.h文件。

可以看出，.h文件类似于c语言的.h文件，.m文件类似于c语言的.c文件。一个c语言编程习惯好的人，通常就是这么设计文档结构的：将实现细节写在一个.c文件中，再引入一个同名的.h文件，该文件用于防止公共声明。

>import 关键字：类似于c语言中的#include, 区别是import能保证头文件不被重复引用。

事实上，一个编码习惯好的C程序员，在写头文件的时候，也通常会在外边套上一圈：

```c
#ifdef __HEADFILE_H__
#def __HEADFILE_H__
#endif
```

Objective-C第一个优美的地方，就在于其文档结构设计，将C语言的良好习惯变成了语言本身。

##.h文件，类接口
OBJ-C中，将.h文件看成一种接口。所以头文件是这么陈述的：
```objc
  @interface MyClass : NSObect
  {
  //成员变量声明
  }
  //对象方法声明
  - (MyClass *)play: (NSString *)aName with: (NSString *)another;
  @end
```
- 最外层的@interface, @end与.h相呼应，再次清晰的体现了这是一个接口，用于对外声明。

- 紧随其后的是类的名字，应与文件名相呼应，体现类的名字。

- ":"和其后的类名NSObject，表明这个类的父类是NSObject。

注意了，**在OBJ-C中":"和自然语言中的":"非常像。**这是OBJ-C的又一优雅之处。在继续学习的过程中，你会对这一特点有更深刻的感触。

OBJC的方法声明非常有特色。我们仔细来看一下。
- 方法声明前的"-"和"+"分别表示该方法是一个实例方法还是一个类方法。这和java里的static很像。
- 方法的返回值类型，参数类型都用括号括起来。因为返回值和传入类型并不涉及到业务逻辑。
- ***方法签名是一句话***, 这是最有特色的一点。这个和其他语言非常不同，刚开始的时候会很不习惯。但很快就会发现这像说话一样自然。或者说，是一句话中的谓语/动宾结构。固定下来的内容是方法签名，使用时确定下来的内容是参数。参数前用":"提示。

最后值得注意的是，如果类具有与其公共接口相关的自定函数、常量或数据类型，则应将其声明放在@interface...@end指令之外。

##.m文件，类实现
类的实现与类接口类似，它首先以***#import***引入类接口，然后以@implementation开始，以@end结束，完成类的实现。
OBJ-C允许对对象使用类名进行静态类型化，也允许使用id进行动态类型化。如：
```objc
MyClass *myObject1;
id myObject2;
```
需要注意的一点是，在OBJ-C中，执行对象引用只能是指针。id类型意味着一个指针。

###对象的使用：发消息
在C语言里，叫做"函数调用"；在面向对象的语言里，我们叫做“方法调用”。在OBJ-C中，我们称作"发消息"。学过java的人都知道，方法调用的格式是"对象.方法"。还记得之前提到优美的方法声明实际上是一句话吗？一句谓语或者是动宾结构。对于一整句话来说，还缺一个主语，主语就是对象或者类。这取决于要执行的方法是对象方法还是类方法（声明的时候前面是-还是+）。

当我们真正要执行方法，也就是某个对象要做某事的时候，我们用[]来描述，一对[]表示某对象做了某件事，主语和谓语用空格分开。执行结果可以作为另一个动作的主语。例如：
```objc
[myObject1 play:basketball with:@"Yaoming"]
```
@符号在OBJ-C中，类似&。

事实上，对于**存取方法**，OBJ-C也可以使用类似java中的点记法来调用。例如：
```objc
myAppObject.theArray = aNewArray;
```
等价于
```objc
[myAppObjcet setTheArray:anewArray];
```

##属性和存取方法
在OBJ-C中，我们往往不直接声明或操作成员变量，而是用属性将其封装起来。使用@property来定义属性，同时自动生成其存取方法及成员变量。格式为：

> @property (选项) 类型 属性名;

例如：

```objc
@property NSString * userName;
```

- 取方法(getter)返回属性的值，名称与属性相同，即userName；
- 存方法(setter)设置属性的值，名称为setUserName，即前面加上set，并将属性第一个字母大写；
- 而真实操作的则是类的成员变量："\_userName"，仅仅在对象初始化和取消分配的方法中，应用程序会直接访问实例的成员变量;（记得吗，在c语言中，\_常常意味着"不可随便访问"）
- 通常在类的接口中声明公共属性，在实现扩展中声明专有属性。
- 控制器对象的属性通常都是专有的

###属性的选项
- copy 赋值时复制
- readonly 只声明getter方法
- weak 弱引用

###成员变量重命名
如果想要成员变量采用其他的名称，可以明确的合成属性。使用@synthesize关键字，例如：
```objc
@synthesize enabled = _isEnabled;
```
这主要是出于一种可读性上的考虑。
也可以在属性声明时对存取方法进行自定义的名称，常用于修改Boolean属性的getter方法，例如：
```objc
@property (assign, getter=isEnabled) BOOL enabled;
```
##块 (刚开始学的时候，只要记住^意味着开始使用块了)
- 本质上是一个可以在任何时刻执行的代码段
- 可移植的匿名函数
- 可作为方法和函数的参数
- 可从方法或函数中返回
- 本身具有一个已类型化的参数列表
- 可以将块赋值给变量，然后像调用函数一样调用它。
- ^是块的语法标记。
看以下代码:

```objc
int multiplier = 7;
int (^myBlock)(int) = ^(int num){ return num * multiplier;};
int result = myBlock(4);
```
先看块中=左边的部分:
- int 表示myBlock块返回int类型的值
- ^myBlock表示myBlock是一个块，
- (int)表示块采用一个参数，参数类型是int
再来看=右边：
- 以^开头表示这是一个块定义
- (int num) 表示定义采用一个int型的参数，名字为num
- { return num * multiplier; };是块的主体，使用参数num，返回一个int值。

###块的用途
块共享局部词法作用范围内的数据。

##协议和类别
类接口声明了一组和类有关的方法和属性，而协议声明了一组和类无关的方法和属性。
协议的基本定义方式：
```objc
@protocol ProtocolName
...
@end
```
- 协议类似于java中的接口，我更喜欢协议这种说法，"协议"二字体现了约定的意义。
- OBJ-C中使用尖括号<>来表示遵守协议。
- 委托和数据源属性通常设置为弱属性。
- 协议可以有可选方法@optional，@optional一直作用到下一个标记出现。

##已定义的类别和编码策略
###重要类型
- id
- Class
- SEL
- Boolean
###保留术语
- self 类似this
- super
